.. _release-notes-6.0:

=================================================
Release Notes for MongoDB 6.0 (Release Candidate)
=================================================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: twocols

.. include:: /includes/in-dev.rst

This page reflects the differences between MongoDB 5.3 and MongoDB 6.0.
MongoDB 6.0 is a |lts| Release, which means that it is supported for
both MongoDB Atlas and on-premises deployments.

If you are upgrading from MongoDB 5.0 to 6.0, you will also see changes
that were introduced in MongoDB Rapid Releases 5.1, 5.2, and 5.3. To see
the changes introduced in these releases, see the following pages:

- :ref:`release-notes-5.1`
- :ref:`release-notes-5.2`
- :ref:`release-notes-5.3`

To learn more about the differences between |lts| and Rapid releases,
see :ref:`release-version-numbers`.

Aggregation
-----------

|sbe-title| Can Execute :pipeline:`$lookup` Stages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /includes/fact-sbe-lookup-overview.rst

For more information, see :ref:`agg-lookup-optimization-sbe`.

Installation
------------

Starting in MongoDB 6.0 (and 5.0.9, 4.4.14, 4.2.20), MongoDB
installations on macOS are notarized. When installing on macOS, you no
longer need to instruct macOS to trust MongoDB binaries.

Time Series Collections
-----------------------

MongoDB 6.0 introduces the following improvements and new features for
time series collections:

Additional Secondary Index Types
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You can add additional :term:`secondary index <secondary index>` types
to :ref:`time series collections <manual-timeseries-collection>`. See
:ref:`timeseries-add-secondary-index-mongodb-6.0` for the additional
indexes and other improvements.

Sort Operations Use Secondary Indexes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Sort operations on time series collections can use indexes to improve
performance. For more information and an example, see
:ref:`timeseries-secondary-index-sort-performance`.

Stable API
----------

Starting in MongoDB 6.0, the following database commands are included in
the :ref:`Stable API <stable-api>`:

.. list-table::
   :header-rows: 1
   :stub-columns: 1
   :widths: 10 20 10

   * - Command
     - Description
     - Stable API Version
   * - :dbcommand:`count`
     - Counts the number of documents in a collection or a view. (Also
       available in the Stable API for 5.0-series deployments starting
       in MongoDB 5.0.9.)
     - V1

To see the full list of database commands available in the Stable API,
see :ref:`stable-api-changelog`.

.. _6.0-rel-notes-general:

General Improvements
--------------------

Capped Collections Improvements
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Starting in MongoDB 6.0, you can change a 
:ref:`capped collection's <manual-capped-collection>` maximum size, either in 
bytes or in number of documents, using the :dbcommand:`collMod` command. See
:ref:`Resize a Capped Collection <resize-capped-collection>` for more details.

``numOrphanDocs`` Field Added to collStats Command
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Starting in MongoDB 6.0, the :ref:`collStats output <collStats-output>` 
includes the :data:`collStats.numOrphanDocs` field that shows the number of 
:term:`orphaned documents <orphaned document>` in the collection. 

Change Streams with Document Pre- and Post-Images
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Starting in MongoDB 6.0, you can use :ref:`change streams
<change-stream-output>` to output the version of a document before and
after changes (the document pre- and post-images). For examples, see
:ref:`db.collection.watch-change-streams-pre-and-post-images-example`.

Exclude Embedded Fields in ``serverStatus`` Output
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Starting in MongoDB 6.0 (and 5.0.9, 4.4.15), you can exclude embedded fields 
from the :dbcommand:`serverStatus` output.

Connections
~~~~~~~~~~~

Starting in MongoDB 6.0, the :method:`Mongo() <db.getMongo()>`
connection object has the following new methods:

- :method:`Mongo.getWriteConcern()` returns the :term:`write concern`
- :method:`Mongo.setWriteConcern()` sets the :term:`write concern`

Sharding
~~~~~~~~

Starting in MongoDB 6.0, the :dbcommand:`enableSharding` command is
no longer required to shard a collection.

.. _6.0-upgrade:

Upgrade Procedures
------------------

Report an Issue
---------------

To report an issue, see
https://github.com/mongodb/mongo/wiki/Submit-Bug-Reports for
instructions on how to file a JIRA ticket for the MongoDB server or one
of the related projects.

.. toctree::
   :titlesonly:
   :hidden:

   /release-notes/6.0-compatibility
   /release-notes/6.0-downgrade
